sap.ui.define(["sap/ui/export/Spreadsheet","sap/ui/export/library"],function(){"use strict";return{uploadFile:function(e){var a=this;var s=new sap.m.Dialog({contentWidth:"300px",resizable:true,type:"Message"});s.setTitle("Carregar arquivo Excel");var t="+
/sap/opu/odata/SAP/ZCA_TIMESHEET_SRV/";var r=new sap.ui.model.odata.ODataModel(t,false);var i=t+"uploadFileSet";var o=new sap.ui.unified.FileUploader({width:"100%",fileType:["xlsx","xls"],typeMissmatch:this.handleTypeMissmatch,uploadComplete:function(e){+
var t=this.oView.sId+"--responsiveTable";var r=this.byId(t);a.templateBaseExtension.getExtensionAPI().refreshTable();s.close();s.destroy();if(e.mParameters.status=="200"||e.mParameters.status=="201"){sap.m.MessageToast.show("Carga realizada com sucesso."+
)}else{if(e.mParameters.response){if(e.mParameters.responseRaw.search("<message>")){var i=e.mParameters.responseRaw.split("<message>")[1].split("</message>")[0];alert(i)}else{alert("Return Code: "+e.mParameters.response,"Response","Response")}}}}.bind(th+
is)});o.setName("Simple Uploader");o.setUploadUrl(i);o.setSendXHR(true);o.setUseMultipart(false);o.setUploadOnChange(false);var n=new sap.ui.unified.FileUploaderParameter({name:"x-csrf-token",value:r.getSecurityToken()});o.insertHeaderParameter(n);var p=+
new sap.m.Button({text:"Upload",type:"Accept",press:function(){var e=o.getFocusDomRef();var a=e.files[0];if(o.getValue()===""){sap.m.MessageToast.show("Favor selecionar um arquivo");return}var s=new sap.ui.unified.FileUploaderParameter({name:"Content-Typ+
e",value:a.type});o.insertHeaderParameter(s);o.insertHeaderParameter(new sap.ui.unified.FileUploaderParameter({name:"SLUG",value:o.getValue()}));o.upload()}.bind(this)});var l=new sap.m.Button({text:"Cancelar",type:"Reject",press:function(){s.close();s.d+
estroy();this.getView().removeAllDependents()}.bind(this)});s.addContent(o);s.setBeginButton(l);s.setEndButton(p);s.open()},handleTypeMissmatch:function(e){var a=e.getSource().getFileType();jQuery.each(a,function(e,s){a[e]="*."+s});var s=a.join(", ");sap+
.m.MessageToast.show("Tipo de arquivo *."+e.getParameter("fileType")+" não é suportado. Escolha um dos tipos a seguir: "+s)}}});                                                                                                                               